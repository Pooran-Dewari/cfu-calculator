<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>CFU & Injection Calculator</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      padding: 40px;
      background-color: #f9fbfc;
      color: #333;
    }

    h2 {
      font-size: 28px;
      margin-bottom: 10px;
      color: #2a4d69;
    }

    hr {
      border: none;
      border-top: 2px dashed #ccc;
      margin: 40px 0 30px;
    }

    .input-group {
      margin-bottom: 15px;
    }

    .input-group label {
      display: inline-block;
      min-width: 260px;
      font-weight: bold;
    }

    .input-group input {
      width: 140px;
      padding: 6px;
    }

    .results {
      background-color: #f0f8ff;
      border-left: 4px solid #2a4d69;
      padding: 15px 20px;
      border-radius: 8px;
      margin-top: 20px;
      line-height: 1.8;
      font-size: 16px;
    }

    .results span {
      font-weight: bold;
      color: #2a4d69;
    }

    .btn {
      margin-top: 15px;
      padding: 10px 20px;
      font-size: 14px;
      background-color: #2a4d69;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }

    .btn:hover {
      background-color: #1f3a52;
    }
  </style>
</head>
<body>

  <!-- Existing CFU calculator stuff goes above -->

  <hr>

  <h2>Injection Calculations</h2>

  <div class="input-group">
    <label for="cfuPerOD1">OD600 = 1.0 → CFU/mL:</label>
    <input type="number" id="cfuPerOD1" value="1e8" step="1e7">
  </div>

  <div class="input-group">
    <label for="perInjectionCFU">Target CFU per injection:</label>
    <input type="number" id="perInjectionCFU" value="1e7" step="1e6">
  </div>

  <div class="input-group">
    <label for="animalCount">Number of animals to inject:</label>
    <input type="number" id="animalCount" value="90">
  </div>

  <div class="input-group">
    <label for="cultureOD">OD600 of bacterial culture:</label>
    <input type="number" id="cultureOD" value="0.4" step="0.01" min="0.01">
  </div>

  <div class="input-group">
    <label for="injectionVolume">Injection volume per animal (µL):</label>
    <input type="number" id="injectionVolume" value="50">
  </div>

  <button class="btn" onclick="updateInjectionCalculations()">Calculate Injection Plan</button>

  <div class="results" id="injectionResults" style="display:none;">
    <div>Animals to inject + 20%: <span id="adjAnimals"></span></div>
    <div>Total CFU required: <span id="totalCFURequired"></span></div>
    <div>Bacterial culture required (mL): <span id="cultureRequired"></span></div>
    <div>Resuspend in ASW (mL): <span id="resuspendVolume"></span></div>
  </div>

  <script>
    function updateInjectionCalculations() {
      const od600CFU = parseFloat(document.getElementById("cfuPerOD1").value) || 1e8;
      const perInjectionTarget = parseFloat(document.getElementById("perInjectionCFU").value) || 1e7;
      const animalCount = parseInt(document.getElementById("animalCount").value) || 90;
      const cultureOD = parseFloat(document.getElementById("cultureOD").value) || 0.4;
      const injectionVolumeUL = parseFloat(document.getElementById("injectionVolume").value) || 50;

      const adjustedAnimals = Math.ceil(animalCount * 1.2);
      const totalCFU = adjustedAnimals * perInjectionTarget;
      const cultureRequired = totalCFU / (cultureOD * od600CFU); // in mL
      const resuspendVolume = (adjustedAnimals * injectionVolumeUL) / 1000; // in mL

      document.getElementById("adjAnimals").innerText = adjustedAnimals;
      document.getElementById("totalCFURequired").innerText = totalCFU.toExponential(2);
      document.getElementById("cultureRequired").innerText = cultureRequired.toFixed(2);
      document.getElementById("resuspendVolume").innerText = resuspendVolume.toFixed(2);

      document.getElementById("injectionResults").style.display = "block";
    }
  </script>

</body>
</html>
